---
layout: post
title: struts2
category: project
description: 终于解决了
---
##其の一
其实struts2文件上传很早之前就在练习了，当时就出现了“页面被重置的这个问题”之前想破了脑袋也不知道是什么原因，今天重头开始写这个小功能，发现之前只是一个劲的上传图片，
会不会是文件格式的问题，随即换了xlsx，之前上传图片，最多只能上传一个，上传两个就显示页面被重置，
其实这个应该早被想到的，就是上传文件的大小限制吗，但是由于struts2根本不报错。直接一个页面被重置。
也真是服了。也许是我自己的经验不足照成的吧。不过现在最起码我认识到了，报错不可怕，可怕的是不报错，直接就给吞了，这个是最可怕的


##其の二
昨天下午就开始进行struts2和hibernate的整合实验，我将它们分别写了测试类，找出了里面的所有的错误之后进行了合并，但是合并调试的时候出现了 hibernate的service.registy报错
于是我将接口部分进行测试，也没有什么问题，但是两者一结合就出现了这个错误，也不知道是怎么搞得，由于它报的是包的错误，所以我就想会不会是包之间的兼容性出现了错误，于是上网找一整套的
jar包，本来想用myeclipse自带的jar包，但是导入之后发现版本太低，语法基本不能兼容，所以果断放弃，于是，在csdn上找到了ssh的jar包，但是由于包含了spring的jar包，所以到进来的时候
一顿报错，于是还得挨个删掉，之前重新建web项目的时候，还出现了忘记配置web.xml的低级错误，害的我访问半天访问不进去。。。。。也是醉了，之后就可以插入一个了，但是也只能插入一个，当插入
多个的时候   Unknown service requested [org.hibernate.engine.jdbc.connections.spi.ConnectionProvider] 还是会报这个错误，由于之前没有见过，所以就baidu了一下。。
请原谅我没有翻墙去google。因为好麻烦，结果还真的找到了，因为插入第一个的时候 sessionfactory已经关闭，再次插入第二个的时候访问就被拒绝了，也是没有办法的事情。于是我将关闭sessionfactory的任务交给
Action了，结果果然好使，哈哈哈，终于搞定一部分了，真是开心啊^_^


##其の三
在之前将下载做完的时候，其实我没有仔细的检查，所以出现了许多的错误，这个的确是大意了，第一，我没有纠正中文乱码问题，以至于前台将数据作为参数带到后台时出现文件名乱码，结果出现找不到文件
即流为空的错误，解决方法new (String.getBytes("ISO8859-1"),"UTF-8"),转换一下编码即可，没什么大问题，之后就是读不出来文件类型的错误，原以为用ognl表达式能够读出来，结果好像失败了
看来是这块学的不太彻底导致的，然后，就是关键的问题就是下载的文件名全部都是我的Action类名，这个上网查了一下，说是没有在Action类中指定getName方法所以默认取得了当前类的名字，但是我明明写了这个方法
不清楚为什么还会出现这个错误，于是照着网上的代码对，结果发现attachment后面的符合，我写的是: 可是他写的是;于是我马上将其改正了过来，果然名称正确了，然后就是岳的程序。。实在是不清楚为什么会出现这个
错误，如果是乱码的话应该会出现inputstream为空的情况，但是他前台传进的文件名的确已经转码了，并且下载的文件已经找到，但是就是弹出的连接，即下载的名称不对，不知道为什么乱码。。。。。等等，我好像明白了什么
真的只是写这个的过程中了解的，浏览器iso8859-1->utf-8,但是这个编码再经过前台编码就变成乱码了，反而iso8859-1->iso8859-1的确没有出现乱码，但是我记得好像发现了他利用response记录了这个东西来着。。好吧，
明天如果遇到了再看一遍。

##其の四
今日はコードをプログラミングします、首先看视频学会了一点,就是modelDriven的使用,当然是基于struts的实现,这个使我不必在前台的页面的name属性上写上user.username之类的
,如果好使的话,也许$.get()方法里面的参数的问题也会一并解决（已证实,好使！！！）,还有就是访问路径和$.get的访问路径问题,貌似这里的路径会将struts里配置的namespace一并算作主机名称,以至于我在两个不同的
package中来回跳转的时候出现了路径访问错误问题，即,在现有的namespace上面附加上当前页面所属的namespace名称,导致不能访问