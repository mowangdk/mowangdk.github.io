---
layout: post
title:  "weekly report"
date:   2022-04-23 22:30:08 +0800
categories: weeklyreport
---

# 论文 

这周路上尝试读了virtio 的论文 https://dl.acm.org/doi/10.1145/1400097.1400108. 虽然论文本身没有太长,但是读起来却非常费劲,想了一下可能是因为对背景和虚拟化 io 不熟悉的原因.相对而言上一篇 ceph 的论文就读的比较顺畅.
简单总结一下, virtio 就是一个虚拟化 io 的协议,它支持多种虚拟化,包括 KVM, Xen, 等一系列虚拟化方案.它的目标是对上层提供一个统一的虚拟化接口, 支持各种的 deivce, 包括存储,网络 io 等. 起到了算是一个 adapter 的作用.
论文里面花了比较重的笔墨说明内部的一个 ringbuffer 的实现,应该算是这个协议的一个创新点吧.显然这篇文档我没有太读懂.后续巩固一下背景知识再来重读一遍


# 日常

### Understanding linux network internals 

上周开了这个坑, 这本书太厚了, 所以基本就是每天早晚读一段, 一周大概读了 10 页左右,说实话按照这个进度不知道要读到那个年头了. 这本书第一章做了一个简介, 从专用语开始介绍, 到基本的一些结构, 一些语法, 并且这些语法的具体用途.
读起来还是受益匪浅的.后续展开的部分估计有些难读

### 容器存储挂载
上周和这周总结了一下容器挂载卸载的具体流程, 以及 kcm & kubelet 内部的具体行为操作, 后续整理出一篇文章发出来, 这篇是只针对 attach & detach 流程的,因为这里面涉及到了 kcm, csi-controller, csi-plugin, kubelet 四个组件,内部大概有 8 个
controller 参与了状态流转, 所以还是很复杂的. 还是值得写一篇文章说明下的



# 社区

-  还是上周的 pr [pr](https://github.com/kubernetes/autoscaler/pull/4798), 这周还是修了一个 comments, 主要是编程习惯之类的修改, 不是什么太大的问题. 这里发现了一个稍微有些诡异的问题.
`resource.MustParse("187500u")` 这个方法返回一个名字叫 `Quantity` 的结构体. 这个结构体的指针方法是包含一个叫 string 的方法的, 但是我却没有办法直接通过该方法的返回值直接调度,让 zhugang 大佬看了下说是返回值没有办法直接取指针调用. 返回值
只可以调用 struct 方法, 必须将返回值赋值给一个变量,才能取指针进行调用. 我这边手动写结构体看了下, 的确是这样. 总之这个 pr 算是通过了. 本来想接着这个 pr 看下 autoscaler 是怎么运作的,不过也只是看了下皮毛,没有深入看.
